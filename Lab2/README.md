# Lab2 — Потоки (WinAPI / std::thread)

Лабораторная демонстрирует работу с **параллельными вычислениями** для массива:
в отдельных потоках вычисляются **min/max** и **среднее значение**, после чего
в исходном массиве **минимальный и максимальный элементы заменяются на average**.

В репозитории две реализации одной и той же логики:

- **WinAPI** — потоки через WinAPI (`CreateThread`, ожидание `WaitForSingleObject`).
- **STDThread** — потоки через стандартную библиотеку C++ (`std::thread`, `join`).

Также в проекте есть **автотесты (Catch2)** и **генерация HTML‑отчёта с помощью Allure**.


## Инструкции по сборке

> Ниже показан пример для сборки одной версии. Для второй версии делайте то же самое,
> но из папки соответствующей версии (WinAPI или STDThread).

1) Создайте папку `build` и перейдите в неё:

```bat
mkdir build
cd build
```

2) Настройте CMake:

```bat
cmake ..
```

3) Соберите проект (для Visual Studio указываем конфигурацию):

```bat
cmake --build .
```

> **Требования:** CMake ≥ 3.15, компилятор C++, установленный Git (для FetchContent/Catch2).

## Запуск приложения

Запуск из папки `build`:

### STDThread версия
```bat
.\Debug\Lab2_STDThread.exe
```

### WinAPI версия
```bat
.\Debug\Lab2_WinAPI.exe
```

### Как работает программа

1) Запрашивает размер массива `N` (N > 0).
2) Запрашивает `N` целых чисел.
3) Выводит исходный массив.
4) В отдельных потоках вычисляет:
   - **min/max** (и выводит их),
   - **average** (и выводит его).
5) Заменяет **min** и **max** элементы массива на **average** и печатает итоговый массив.


## Тестирование

Запуск тестов (из папки `build`):

```bat
.\Debug\tests.exe
```

## Генерация отчёта Allure

Проект умеет запускать тесты через CTest и экспортировать результат в JUnit XML,
а затем (если установлен Allure CLI) сгенерировать HTML‑отчёт.

### 1) Сгенерировать JUnit (allure-results/junit.xml)
Из папки `build`:

```bat
cmake --build . --target run_tests_xml --config Debug
```

### 2) Сгенерировать HTML‑отчёт Allure
Если Allure установлен и доступен в PATH (`allure` / `allure.bat`), выполните:

```bat
cmake --build . --target allure_report --config Debug
```

### Просмотр отчёта

Откройте в браузере файл:

```text
build\allure-report\index.html
```

> Примечание: если Allure не установлен, цель `allure_report` не создаётся.
> В этом случае можно использовать только `run_tests_xml`.

## Возможности

- Ввод и вывод массива целых чисел.
- Поиск **минимального** и **максимального** элементов массива.
- Расчёт **среднего значения**.
- Замена min/max на average.
- Две реализации потоков: **WinAPI** и **std::thread**.
- Автотесты на Catch2 + отчёты Allure.
